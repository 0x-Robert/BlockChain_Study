# 암호학

- 암호학은 그리스어로 "비밀 작성"을 뜻하지만 암호학 연구는 "암호화(encryption)"라고 하는 단순 비밀작성 이상의 것을 포함한다.

* 이더리움에서 사용하는 암호방식 : 공개키 암호화(Public Key Cryptography, PKC)
* 이더리움은 외부 소유 계정 (Externally Owned Account, EOA)와 컨트랙트(contract)라는 두가지 유형의 계정을 갖고 있다.
* 디지털 개인키(private key), 이더리움 주소(ethereum address), 디지털 서명(digital signature)를 통해 외부 소유 계정(EOA)의 이더 소유권을 확립한다.
* 계정 주소는 개인키에서 파생된다. / 개인키는 계정(account)라고 불리는 단일 이더리움 주소를 고유하게 결정한다.
* 이더리움 시스템은 개인키를 이더리움에 전송하거나 저장하는 방식으로 직접 사용되지 않고 비공개로 유지되어야 한다.
* 계정 주소와 디지털 서명만 이더리움 시스템에 전송되고 저장된다.
* 개인키를 사용하여 생성된 디지털 서명을 통해 자금의 접근과 통제가 이루어진다.
* 외부소유계정(EOA)의 이더리움 주소는 공개키-개인키 쌍에서 공개키에서 생성된다.
* 공개키 암호화(비대칭 암호화라고도 함)은 오늘날 정보 보안의 핵심요소다. 1970년대 마틴핼먼(Martin Hellman), 휫필드 디피(Whitfield Diffie), 랄프 머클(Ralph Merkle)이 공개했다.
* 공개키 암호화는 고유한 키를 사용해서 정보를 보호한다. 이 키는 특수한 속성(계산은 쉽지만 그 역계산은 어려운 속성)을 가진 수학함수를 바탕으로 한다.
* 초기 공개 키 암호 방식은 아주 큰 정수를 2개 이상의 소수로 나누는 것이 오래걸리는 것에 기반을 두고 있다
* 이런 수학함수 중 일부는 다음과 같다.
* 트랩도어함수(trapdoor function) : 8,018,009가 두 소수의 곱일 때 비밀정보 중 하나가 소인수 중 하나가 2,003이라고 하면 나머지는 쉽게 찾을 수 있다. 그러나 역산하기 위한 단축키로 사용할 수 있는 비밀 정보가 없을 때는 8,018,009의 역계산이 어렵기 때문에 트랩 도어 함수라고 한다.
* 암호화에 유용한 수학함수의 발전은 타원곡선의 산술연산을 바탕으로 한다. 타원곡선산술에서 소수로 나눈 나머지를 곱하는 것은 간단하지만 나눗셈(역산)은 사실상 불가능하다.
  이것을 이산 로그 문제(discrete logarithm problem)라고 하며 현재는 알려진 트랩도어는 없다.
* 타원곡선 암호화(elliptic curve cryptography)는 이더리움 및 기타 암호화폐에서 개인키와 디지털 서명을 사용하는 기초가 된다.
* 타원곡선 암호 또한 알려진 특정한 점에 대한 무작위 타원 곡선의 이산 로그를 찾는 것이 오래걸린다는 점에서 착안하였다.
* 암호화 목적으로 타원곡선은 평면곡선의 한 종류로 다음의 방정식을 만족하는 점(무한 원점포함)들의 집합이다. (곡선의 단순함을 위해 점들은 표수가 2나 3이 아닌 고정된 유한체이다.)
  y^2 =x^3 + ax +b

* 타원 곡선 산술 연산
* 정수산술과 유사
* 타원곡선 암호화는 타원 곡선의 점에 대하여 더하기와 곱셈으로 표현되는 이산 대수 문제를 바탕으로 한 비대칭 또는 공개키 암호화 유형이다.

- 타원 곡선에 두 점 P1과 P2가 주어지면 세 번째 점 P3 = P1 + P2가 타원 곡선 위에 있도록 타원 곡선 덧셈을 정의한다.
- 타원곡선수학에서는 무한대 점이라는 점도 있다. 대략 숫자 0의 역할에 해당한다.
- 왜? 어떤 경우에 P1과 P2의 x 값이 동일하고 y값은 다르다면 이 선은 수직일테고 P3는 무한대점이 된다.
- 공개키 생성 : 무작위로 생성한 숫자 k형태의 개인키로 시작하여 생성자 점G라고 하는 곡선의 미리 결정된 점에 개인키를 곱하여 곡선상의 다른 점, 즉 대응하는 공개키 K를 생성한다.
  K = k \* G ( 반복되는 덧셈, G + G + G + G + ... G (k번 반복됨))
  G와 개인키 k를 곱한 결과는 항상 공개키 K로 같다. 개인키 k와 공개키 K는 고정되어 있지만 k에서 K까지 한 방향으로만 계산할 수 있다.

* 정리 : 개인키는 공개키로 변환할 수 있지만 공개키는 개인키로 다시 변환할 수 없다. 이는 수학이 한방향으로만 동작하기 때문이다. 공개키에 대해서 두 소수의 곱이라고 할 경우에는 곱한 결과는 쉽게 구하지만 개인키를 구하려고 하면 역산을 해야하는데 이 때 개인키 이외의 소수에 대해서 알지 못하면 구하는 것이 거의 불가능하기 때문이다.
  (소수와 소인수분해의 관점에서 보면 2개의 큰 소수를 곱하는 것은 간단하지만 2개의 큰 소수의 곱을 감안할 때 소인수 분해를 찾는 문제는 매우 어렵기 때문이다.)

# 참고

- 영 지식 증명(zero knowledge proof)
- 동형 암호화(homomorphicencryption)
- 암호학(http://bit.ly/2DcwNhn) - https://en.wikipedia.org/wiki/Cryptography
  (공개키 암호시스템, 대칭키 시스템)
- 타원곡선암호(Elliptic curve cryptography) : https://ko.wikipedia.org/wiki/%ED%83%80%EC%9B%90%EA%B3%A1%EC%84%A0_%EC%95%94%ED%98%B8
- 트랩도어함수(http://bit.ly/2zeZV3c) : https://ko.wikipedia.org/wiki/%ED%8A%B8%EB%9E%A9%EB%8F%84%EC%96%B4_%ED%95%A8%EC%88%98
- 타원곡선암호 : https://web.archive.org/web/20170428225556/http://www.secg.org/SEC1-Ver-1.0.pdf
- Certicom은 타원곡선암호와 관련된 원천기술을 가진 회사이며, 2003년에 미국 NSA와 타원곡선암호 기술에 관한 라이선스 계약을 맺었다. : https://blackberry.certicom.com/en
- SEC1. 타원곡선 암호 표준 : https://web.archive.org/web/20170428225556/http://www.secg.org/SEC1-Ver-1.0.pdf
- SEC2. 제안된 곡선들 : https://web.archive.org/web/20170630012610/http://www.secg.org/SEC2-Ver-1.0.pdf
- 페르마의 소정리
  https://namu.wiki/w/%ED%8E%98%EB%A5%B4%EB%A7%88%EC%9D%98%20%EC%86%8C%EC%A0%95%EB%A6%AC
- 이산로그문제 : https://nyan101.github.io/blog/algorithms-for-discrete-logarithm-problem#:~:text=%EC%9D%B4%EC%82%B0%20%EB%A1%9C%EA%B7%B8%20%EB%AC%B8%EC%A0%9C%EB%8A%94%20%EC%9D%B4%EC%82%B0,k%EB%A5%BC%20%EC%B0%BE%EB%8A%94%20%EB%AC%B8%EC%A0%9C%EC%9D%B4%EB%8B%A4.
- 정수론 :https://namu.wiki/w/%EC%A0%95%EC%88%98%EB%A1%A0
- openssl : https://www.openssl.org/
- libsecp256k1 https://github.com/0x-Robert/secp256k1
- http://wiki.hash.kr/index.php/%ED%83%80%EC%9B%90%EA%B3%A1%EC%84%A0%EC%95%94%ED%98%B8
- http://wiki.hash.kr/index.php/%EC%9D%B4%EC%82%B0%EB%A1%9C%EA%B7%B8
- https://ko.wikipedia.org/wiki/%EC%9D%B4%EC%82%B0_%EB%A1%9C%EA%B7%B8

# 출처

마스터링 이더리움

# 기타 개념들

### 이산로그

```
1. 이산거듭제곱의 역함수다.
2. a^x = b를 만족하는 x를 가리킨다.

이산 로그(離散--, discrete logarithm)는 일반 로그와 비슷하게 군론에서 정의된 연산으로  a^x=b를 만족하는  x를 가리킨다.
이산 대수(離散對數)라고 부르기도 한다.

이산 로그의 가장 단순한 형태는 Z[p]에서 정의한다.
Z[p]의 집합은 {1,2,...p-1}이고 소수 p를 법으로 가지는 모듈로 곱셈에 대해서 닫혀있다.
이 군에서 어떤 수의 k 제곱을 구하려면, 그 수를 k번 제곱한 다음 p로 나눈 나머지를 구하면 된다. 이런 연산을 이산 거듭제곱(discrete exponentiation)이라고 한다.
예를 들어, Z[7]*에서 3의 5제곱을 구하는 경우, 35=243 이고 243을 7로 나눈 나머지가 5이므로 Z[7]*에서 3^5=5이다.
이산 로그는 이산 거듭제곱의 역함수이다.
앞의 예제를 사용하여 설명하면, 3^k ≡ 5 (mod 7)일 때 이 조건을 만족시키는 가장 작은 k가 Z[7]*에서 밑이 3인 5의 이산 로그값이다.
이산로그문제(discrete logarithm problem)라고도 한다.

이산 로그의 정의를 일반화하면 다음과 같다. G가 n개의 원소를 가진 유한 순환군이라고 하자. 이 군은 곱셈군이라고 가정한다. b가 G의 생성원(primitive root, primitive element)이면 G의 모든 원소 x는 임의의 정수 k에 대하여 x = bk의 형태로 쓸 수 있다. 또한 x를 표현하는 모든 원소들은 모듈로 n에 대해 합동이다. 이런 조건에서 다음과 같은 함수를 정의한다.

log[b] : G -> Z[n]



```

### 순환군

```
군론에서 순환군(循環群, 영어: cyclic group)은 한 원소로 생성될 수 있는 군이다.
즉, 순환군의 모든 원소는 어떤 고정된 원소의 거듭제곱이다.
(군의 연산이 곱셈이 아닌 덧셈일 경우, 모든 원소는 고정 원소의 정수배이다.)

여기서 Zn은 정수 n을 법으로 가지는 환이고 x에는 모듈로 n에 대한 congruence class를 할당한다. 이와 같은 군 동형사상을 밑이 b인 이산 로그라고 부른다.

로그 함수의 밑변환은 이산 로그에서도 그대로 적용된다. c가 G의 또다른 생성원이면, 다음 식이 성립한다.

log[c]{x} = log[c]{b} * loc[c]{x}
```

### 이산로그 문제

```

이산 로그 문제
이산 로그 문제는 이산 대수 문제라고도 하며, 순환군 ⟨g⟩
와 군의 원시근(primitive root) g , 그리고 y∈⟨g⟩가 주어졌을 때, y=g^k
를 만족하는 최소의 자연수 k 를 찾는 문제이다. 암호학에서는 큰 소수 p
에 대해 p 로 나눈 나머지들의 모임인 Z∗p 를 사용하는 경우가 많다.

일반적인 실수(R
) 체계에서 이는 loggy가 된다는 점에서 이산 로그 라는 이름이 붙었으며, a<b
 이면 logga<loggb 라는 성질을 이용해 산술적으로 쉽게 해를 구할 수 있는 일반적인 로그 문제와 달리 군에서는 이러한 대소 비교가 원활하지 않기에 어려움이 있다.

 예로 mod 13에 대해 원시근 g가 2인 상황을 살펴보자

k
0	1	2	3	4	5	6	7	8	9	10	11	12

gk
1	2	4	8	3	6	12	11	9	5	10	7	1

6 > 5 이지만 gk=5를 만족하는 k는 5, gk=5를 만족하는 k는 9로 대소 관계가 유지되지 않는다. 이러한 불규칙성으로 인해 일반적인 이산 대수 문제를 해결하는 효율적인 알고리즘은 아직 발견되지 않았다.

이제 이를 해결하는 몇 가지 방법들에 대해 알아보자. 단 문제를 풀 순환군이 소수 p
에 대해 Z∗p  인 경우만을 생각하며, 편의상 군의 크기를 n(=p−1)
으로 표현하기로 한다.

```

### 페르마의 소정리

```

페르마의 소정리(Fermat's little Theorem)

p가 소수면 모든 정수 a에 대해 a^p = a(mod p)다.
혹은
p가 소수고 a가 p의 배수가 아니면 a^(p-1) = 1 (mod p)다.


두 정리는 동치인 정리이다.

페르마의 소정리, 혹은 페르마의 작은 정리라고도 불리는 이 정리는 피에르 드 페르마가 알아낸 정리로서, 정수론의 가장 기본이 되는 동시에 KMO를 응시하는 학생들 모두가 아는 4대 정리 중 하나다. [2] 역시 페르마답게 증명은 하지 않고 편지를 통해 이 정리에 대해 발표했지만, 그 사실 발견 자체가 놀라운 일이므로 페르마의 소정리라고 부른다.

한 마디로 임의의 소수  p와 서로소인 한 수의 (p-1)승을 p로 나눈 나머지는 무조건 1이라는 정리 눈으로 보이는 간결성만큼 효과도 매우 강력한 정리이다. 정수론에서 별 되도 않는 자명한 명제를 증명한답시고 붙잡고 있다고 '착각하던' 사람들도 합동식 개념을 접하는 동시에 4대 기본 정수론 정리들을 접하는 즉시 정수론에 대한 호기심이 급증한다고들 한다 64^70을 71로 나눈 나머지는 1이라는 것을 순식간에 알 수 있다.
더나아가서 64의 70의 배수 거듭제곱을 71로 나눈 나머지도 쉽게 구할 수 있다.

64^70000000을 71로 나누면 나머지가 1이다.



```

### 서로소

```
서로소(coprime)는 공약수가 1뿐인 두 정수나, 공약수가 0이 아닌 상수뿐인 두 다항식이나, 환 전체를 생성하는 두 아이디얼의 관계이다.

```

### 수학적 귀납법

```
數學的 歸納法 / mathematical induction

이름 때문에 귀납논증과 혼동할 수 있겠지만, 엄밀히 말하면 연역논증의 일종이다. 증명 과정이 타당하다면 결론 역시 반드시 타당하기 때문에 완전귀납법이라고도 한다.
자연수에 관한 명제  P(n)이 모든 자연수(또는, 어떤 자연수보다 큰 모든 자연수)에 대하여 성립함을 보이는 증명법이다

```

### 정수론

```

Die Mathematik ist die Königin der Wissenschaften, und die Arithmetik ist die Königin der Mathematik.
수학은 만학의 여왕이고 정수론은 수학의 여왕이다.
- 카를 프리드리히 가우스
整數論 / Number theory[1]

정수론, 또는 수론은 정수(ℤ)의 성질 또는 정수가 등장하는 경우[2]들을 연구하는 학문이다. 위의 가우스 명언 속에서 보이듯 원래 정수론은 산술(Arithmetik)에서 출발했으나 현대 독일어에서도 산술이 아닌 Zahlentheorie라 부른다[3].
```

### 합성수

어떤 수를 1보다 큰 동일한 수로 분해할 수 있다면 이것을 합성수라고 한다.
